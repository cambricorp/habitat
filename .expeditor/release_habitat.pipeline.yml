expeditor:
  defaults:
    buildkite:
      timeout_in_minutes: 30
      env:
        HAB_LICENSE: "accept-no-persist"
        HAB_STUDIO_SECRET_HAB_LICENSE: "accept-no-persist"

steps:
#######################################################################
# Release!
#######################################################################

  - label: "[build hab]"
    command:
      - .expeditor/scripts/build_component.sh hab
    expeditor:
      secrets:
        HAB_AUTH_TOKEN:
          path: account/static/habitat/chef-ci
          field: scotthain-sig-key
      executor:
        docker:
          privileged: true
          environment:
            - HAB_ORIGIN=core
            - BUILD_PKG_TARGET=x86_64-linux # TODO: best place to put this?
#            - HAB_AUTH_TOKEN
            # TODO If you add quotes, then that can affect things in unexpected ways. Using "x86_64-linux" ends up failing in a bash case statement somehow
            #- HAB_BLDR_URL=https://bldr.acceptance.habitat.sh
